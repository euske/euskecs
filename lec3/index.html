<!DOCTYPE HTML>
<html lang="ja">
<head>
<title>コンピュータ・ネットワーク</title>
<style><!--
body { line-height: 1.5; }
table { border-collapse: collapse; }
td { padding: 0.5em; text-align: center; }
p { margin: 0; }
.figure { margin: 0.5em; padding: 0.5em; border: 1px solid gray; }
--></style>
</head>
<body>
<h1>コンピュータ・ネットワーク</h1>

<h2>コンピュータ・ネットワークとは</h2>
<p>
複数のコンピュータどうしを線でつないで通信すること。
<p>
「道路」と同じようにインフラの一部。
<p>
過去にはいろいろなネットワークがあったが、
現在は「ザ・インターネット (The Internet)」が
よく使われている。
<h4>範囲による分類</h4>
<ul>
  <li> LAN (Local Area Network) … 局所ネットワーク、ひとつの場所・組織のみ。
  <li> WAN (Wide Area Network) … 広域ネットワーク、自治体から全世界まで。
</ul>

<h3>なにに使うのか?</h3>
<ul>
<li> 個人用
<ul>
  <li> 通信: 電子メール、LINE
  <li> 調べもの: ウェブ
  <li> エンターテインメント: YouTube, Hulu, オンラインゲーム
</ul>
<li> 業務用
<ul>
  <li> 商品の発注・見積り … EDI (Electronic Data Interchange)
  <li> 金融情報 (払い込み・引き落し) … 全銀BSC手順、SWIFT, VISANet
  <li> その他、各業務の情報
  <ul>
    <li> 物流管理 (鉄道、飛行機、郵便物、座席予約)
    <li> 事業所間の情報共有 (コンビニ、レストラン、クリーニング、etc.)
    <li> 顧客情報、医療情報
  </ul>
</ul>
</ul>

<h3>どうやって送るのか?</h3>
<p>
究極的にはネットワークにはふたつの方式しかない。

<h4>A. 回線交換</h4>

<ul>
<li> 公衆回線 (電話)
 <ul>
  <li> 長所: 安価で信頼性がある。
  <li> 短所: 遅い、使えないときがある。
 </ul>
<li> 専用線
 <ul>
  <li> 緊急用回線、衛星回線など。
  <li> 長所: ふつうの回線が使えないときも使える。
  <li> 短所: 非常に高価。
 </ul>
</ul>

<h4>B. パケット通信</h4>

<ul>
<li> インターネット
 <ul>
  <li> 長所: 非常に安価かつ広範囲。
  <li> 短所: 盗聴される、信頼性なし。
 </ul>
</ul>


<h2>ネットワークにおける課題</h2>
<p>
ネットワークは構築するのが大変だ。(道路と同じ)
<ul>
<li> いろいろな端末・機器を変えたい。 =  送信機・受信機 (クライアント/端末) の自由
<li> いろいろな用途に使いたい。 = 伝えたい「内容」 (アプリケーション) の自由
<li> いろいろな伝送経路を使いたい。 = 伝送媒体 (メディア、“土管”) の自由
</ul>
<p>
いくつかの取り替え可能な「部品」から作る。(ソフトウェアと同じ)

<div class=figure>
<table border>
<tr><td>アプリケーション層</td></tr>
<tr><td>TCP層</td></tr>
<tr><td>IP層</td></tr>
<tr><td>データリンク層</td></tr>
</table>
</div>

<p>
テレビと比較すると、インターネットでは上の要素はどれも可変である。
唯一の規格はパケット送受信の方式 (プロトコル) だけ。
<p>
(電気を使わなくてもかまわない:
<a href="http://www.blug.linux.no/rfc1149/">http://www.blug.linux.no/rfc1149/</a>)

<h4>その他の要求事項</h4>
<ul>
<li> 情報は確実・正確に相手に送ること。
<li> 回線はみんなで公平に使うこと。
<li> 通信の秘密を守ること。
</ul>

<h2>コンピュータ・ネットワークの基本的なしくみ</h2>

<h3>Ethernet (データリンク層)</h3>
<p>
LAN におけるデータリンクでもっともよく使われる。
ブロードキャストが基本。(「バス」に似ている)
<p>
MACアドレスで各機器を識別する。
<p>
無線LANもEthernetの一種。
(電波だから当然ブロードキャストされる)

<h3>IP層 (ネットワーク層)</h3>
<P>
データ (0/1) が2点間で信頼できる方法で送れるようになったら、
次はそれを使って離れた地点にパケットを送る。
<h4>IPアドレス</h4>
<p>
インターネット上のある「地点」とは、「IPアドレス」によって表現される。
これは<u>物理的な場所とは何の関係もない。</u>
<p>
全世界で32ビット。
インターネットを使う<u>すべての</u>機器には
IPアドレスが必要である。→ アドレスが足りない。
<ul>
<li> <code>127.0.0.1</code>
<li> <code>58.158.55.222</code>
<li> <code>255.255.255.255</code>
</ul>
<p>
そこで、以下のアドレスは組織内で勝手に使うことができるという
決まりになっている。(プライベート IPアドレス)
<ul>
<li> 10.0.0.0/8
<li> 172.16.0.0/12
<li> 192.168.0.0/16
<li> ...
</ul>

<h4>ルータ</h4>
<p>
IPパケットは、複数台のコンピュータを経由して転送される。
このようなIPパケットを転送するコンピュータを「ルータ (router)」とよぶ。
<p>
ルータは受けとったパケットをいったんメモリに保管し、
適切な送り先に向けて送信する。
<p>
コンピュータから見ると、インターネットの世界はこうなっている。
<a href="http://personalpages.manchester.ac.uk/staff/m.dodge/cybergeography/atlas/topology.html">Atlas of Cyberspaces</a>
<ul>
<li> インターネットの全体像はわからない。
<li> ケーブルの容量・速度もわからない。
</ul>

<p>
<strong>ルータのおもな機能:</strong>
<ul>
<li> NAT機能 (Network Address Translation)
<p> プライベートネットワークとインターネットを接続するための仕組み。
どのプライベートIPアドレスが
どのグローバルIPアドレスとTCPで通信しているかを
覚えておき、IPパケットを書き換える。
<li> ファイヤーウォール機能。
<p> 害のありそうなパケットを通さない (フィルタ)。
</ul>

<p>
<strong>家庭用ルータの機能:</strong>
<ul>
<li> モデム機能
<li> NAT機能
<li> ファイヤーウォール機能
<li> 無線アクセスポイント
<li> ...
</ul>

<h3>サーバ</h3>
<ul>
<li> クライアント・サーバ … 「サービス」と「客」が存在する。
<ul>
 <li> サーバ (マシン) … つねに電源が入っている。
 <li> クライアント (マシン) … 勝手なときに来店。
</ul>
</ul>


<h3>アプリケーション層</h2>

<h4>World Wide Web (WWW)</h4>
<ol>
<li> クライアント (ブラウザ) がコンテンツを要求する。
<li> サーバがコンテンツを提供する。
</ol>
<p>
たとえばブラウザで
<center>
<code>http://<span class=bgy>www.example.com</span></span><span class=bgg>/news/2015/</span></code> 
</center>
というURL を開くと、PC はインターネット上のサーバ
"www.example.com" と通信し、以下のような HTML 文書を取得する。
<blockquote><pre>
&lt;html&gt;
...
</pre></blockquote>
<p>
これをブラウザが画面に表示し、ユーザが閲覧する。

<h4>電子メール</h4>
<ol>
<li> クライアント (メーラ) がメッセージを送る。
<li> サーバがメッセージを受けつける。
</ol>
<p>
たとえば電子メールソフトで
<center>
<code>shinyama@example.com</code>
</center>
というメールアドレスにメールを送ると、PC はインターネット上のサーバ
"<code>mail.example.com</code>" と通信し、そのサーバ上に登録されている
ユーザ "<code>shinyama</code>" 宛に電子メールの本文を送信する。

<h2>セキュリティとは何か?</h2>
<ul>
<li> 機密性 (Secrecy)
<li> 完全性 (Integrity)
<li> 可用性 (Availability)
</ul>
<p>
「金庫の設計図があっても、金庫の鍵がなければ開かない」 (Bruce Schneier)

<h3>コンピュータセキュリティの価値</h3>
<p>
<a href="http://krebsonsecurity.com/2012/10/the-scrap-value-of-a-hacked-pc-revisited/">ハックされたPCの価値</a>。
<ul>
<li> ウェブサーバを動かす: 違法サイトの構築。
<li> スパムロボットを動かす: 違法広告は金になる。
<li> パスワードを盗む: 複数のサイトのパスワードを集めて売る。
<li> 金融情報を盗む: 証券情報、クレジットカード情報などを売る。
<li> さらし者にする: Twitter, Google+, Facebook アカウントを乗っとる。
<li> ライセンスキーを盗む: 高額なソフトウェアのライセンスキーを盗んで売る。
<li> 脅迫に使う。Ransomware。
<li> 他の遠隔攻撃の踏み台にする。
</ul>

<p>
<a href="http://krebsonsecurity.com/2013/06/the-value-of-a-hacked-email-account/">ハックされたアカウントの価値</a>。
<ul>
<li> スパムあるいは詐欺に使う。
<li> 「いいね!」を売る。
<li> (同じパスワードを別のところで使っている場合) パスワードを盗んで再利用する。
</ul>


<h2>ネットワークのセキュリティ</h2>
<p>
TCP/IPによる通信では、たしかにデータは信頼性ある方法で
送受信できるが、通信そのものが安全 (secure) かはわからない。
ルータはパケットを中継しているため、途中で流れている情報を見ることができる。

<ul>
<li> 盗聴 (eavesdropping)
<li> なりすまし (spoofing)
<ul>
<li> ルータの乗っ取り
<li> DNS偽装
</ul>
</ul>

<p>
これを防ぐため、
現在では HTTP のかわりに、暗号を使った
HTTPS を使っているところも多い。

<ul>
<li> 暗号化
<li> 認証
</ul>

<h3>暗号 (Cryptography) とは何か?</h3>
<ul>
<li> 平文 (plaintext) ←[暗号]→ 暗号文 (ciphertext)
<li> 鍵が必要。
<li> さまざまな「暗号アルゴリズム」がある:
RC4, DES, 3DES, AES128, AES256, Blowfish, Chacha20, ...
</ul>

<h3>暗号における大きな問題</h3>
<p>
暗号を使うためには、まず鍵を相手に知らせる必要がある。
(鍵配送)
<p>
盗聴されているかもしれない状況で、
どうやって鍵を安全に相手に知らせるのか?

<h2>電子署名 (Digital Signature)</h2>
<p>
一方向ハッシュ関数 + 公開鍵暗号
<ul>
<li> ある情報を秘密鍵で署名 (sign) する: {X, E(H(X))}
<li> その情報が正しいことを公開鍵で検証 (verify) する: {X, D(S)}
</ul>
<ul>
<li> もしデータが改竄されていれば、ハッシュが合わない。
<li> もしハッシュが改竄されていれば、公開鍵と合わない。
</ul>
<p>
現実世界では、署名(印鑑)によって書類の正しさを証明する。

<h2>鍵配送の問題</h2>
<p>
暗号は、認証と組み合わせて始めて安全になる。
<p>
「最初の一回」は、なにか別の方法で確認しなければならない。
<p>
「信頼できる第三者」 = 認証局 (Certificate Authority, CA)

<h3>証明書</h3>
<p>
証明書: 
<blockquote class=gray><center>
“この者の公開鍵がこれであるということを証明する (以下署名)”
</center></blockquote>
<p>
現実世界と同じく、これは階層的になっている。(証明書チェーン)<br>
<p>
なぜ証明書を分けるのか?
<ul>
<li> リスクを分散するため。
<li> 効率化のため。(代理店)
</ul>
<p>
証明書には 2種類ある:
<ul>
<li> 暗号化だけをおこなうもの。
<li> 「現実世界との関係」を証明するもの。(登記情報が入っている)
</ul>

<h2>インターネットと監視社会</h2>
<h3>検索エンジンによる情報の漏洩</h3>
<p>
たとえば Google は、個人が検索したキーワードや見たサイトをすべて記録している。
「検索エンジンはあなたよりもあなたのことをよく知っている」と言われる。
2006年、AOL での検索エンジン記録が流出。
<a href="http://techcrunch.com/2006/08/06/aol-proudly-releases-massive-amounts-of-user-search-data/">記事1</a>, 
<a href="http://query.nytimes.com/gst/abstract.html?res=9E0CE3DD1F3FF93AA3575BC0A9609C8B63">記事2</a>。
<h3>広告業界による監視</h3>
<p>
商品を宣伝するときには、
客の情報を詳しく知っていたほうが有利 → 個人情報は金になる。
<a href="http://www.hrks.jp/advertising/ad_list.html">雑誌広告の価格一覧</a>。
Google AdWords: 1クリック およそ 100円。
<p>
「ネットのものがタダであるとき、売られているのは自分」
<h3>国家レベルの盗聴</h3>
<p>
2013年、NSA元職員によるリーク。
米国・英国政府は日常的に国民・外国人の通信を盗聴し、
何年間も蓄積していると言われている。

<hr>
<address>Copyright (c) 2015 Yusuke Shinyama</address>
